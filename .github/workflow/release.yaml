name: release
run-name: Pypi releasing
on: 
  workflow_dispatch: 
  push: 
   branches:
    - master
   tags: 
    - v0.1.**
  
permissions:
  contents: read
  pull-requests: read

jobs:
 builds:
  strategy:
   matrix:
    python: [3.7]
    os: [ubuntu-latest, windows-latest, macos-latest]
  runs-on: ${{ matrix.os }}
  steps:
   - name: checkout
     uses: actions/checkout@v3

   - name: check python version
     uses: actions/setup-python@v4
     with:
      python-version: ${{ matrix.python }}
   - name: install maturin
     run: pip install maturin

   - name: build
     run: maturin build --release --features ffi_py